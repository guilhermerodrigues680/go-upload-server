<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script defer src="vendor/axios.min.js"></script>
    <script defer src="index.js"></script>
    <script defer src="vendor/alpinejs.min.js"></script>
    <link rel="stylesheet" href="index.css" />
    <title>GO Upload Server</title>
  </head>
  <body>
    <header>
      <div class="wrapper">
        <div class="header-container">
          <h1>GO Upload Server</h1>
        </div>
      </div>
    </header>

    <main>
      <div class="wrapper">
        <section x-data="fileFormData">
          <form
            class="file-form"
            x-ref="form"
            @submit.prevent="handleFormSubmit"
          >
            <!-- TODO: isDragover -->
            <label
              class="input-file-container"
              @drag.prevent=""
              @dragstart.prevent=""
              @dragover.prevent="isDragover = true"
              @dragenter.prevent="isDragover = true"
              @dragend.prevent="isDragover = false"
              @dragleave.prevent="isDragover = false"
              @drop.prevent="isDragover = false, handleDropFiles($event)"
            >
              <p>Enviar um arquivo:</p>
              <span>Escolher Arquivos</span>
              <input type="file" multiple @change="handleFileInputChange" />
            </label>

            <template x-for="f in selectedFiles">
              <div>
                <span x-text="f.name"></span>
              </div>
            </template>

            <div class="file-submit-container">
              <button type="submit">Enviar</button>
            </div>
          </form>

          <div class="upload-progress" x-show="uploading">
            <span class="fixed-message">Upload progress:</span>
            <span class="variable-message" x-text="uploadProgress"></span>
            <span class="variable-message" x-text="uploadProgressText"></span>
          </div>
        </section>

        <section x-data="fileListDataFunc">
          <div x-text="$store.dir.path"></div>
          <div class="file-list-row file-list-row--header">
            <span class="file-list-column">Arquivo</span>
            <span class="file-list-column">Tamanho</span>
            <span class="file-list-column">Mode(<abbr title="IsDir,Owner,Group,Public">OGP</abbr>)</span>
            <span class="file-list-column">Última modificação</span>
          </div>

          <!-- TODO Loading -->
          <div x-show="loading">Carregando...</div>

          <!-- TODO: desativar up -->
          <div
            class="file-list-row file-list-row--item"
            @click="handleClickBack()"
          >
            <span class="file-list-icon file-list-icon--dir"></span>
            <span class="file-list-column">../</span>
            <span class="file-list-column"></span>
          </div>

          <template x-for="f in $store.dir.fileList">
            <div
              class="file-list-row file-list-row--item"
              @click="handleClickFile(f)"
            >
              <span
                class="file-list-icon"
                :class="f.isDir ? 'file-list-icon--dir' : 'file-list-icon--file'"
              ></span>
              <span class="file-list-column" x-text="f.name"></span>
              <span
                class="file-list-column"
                x-fbytes:kib.4="f.size"
              ></span>
              <span
                class="file-list-column"
                x-text="formatChmod(f.mode)"
              ></span>
              <span
                class="file-list-column"
                x-text="formatDate(f.modTime)"
              ></span>
            </div>
          </template>
        </section>
      </div>
    </main>

    <footer>
      <div class="footer-container">golanguploadserver</div>
    </footer>
  </body>
</html>
